# Chess Imitation Learning with Stockfish and PyTorch

## Overview

This project implements **imitation learning** for chess using the **Stockfish** chess engine, **PyTorch**, and **python-chess**. The goal is to train a neural network that predicts the best chess move from a given board state by imitating Stockfish's decisions. 

The project generates a dataset of chess board positions and corresponding optimal moves (as determined by Stockfish), then trains a neural network to learn to predict the best move from a given position. After training, the model can predict optimal moves on unseen chess positions, imitating Stockfish's behavior.

## Features

- **Stockfish Integration**: The project uses Stockfish to generate expert moves for a given board state.
- **Neural Network**: A simple fully connected neural network is built using PyTorch to predict the best move.
- **Board Representation**: Chess board states are converted into a numerical tensor representation that serves as input to the neural network.
- **Move Prediction**: The neural network is trained to predict the best move for any given board state, based on the data generated by Stockfish.
  
## Project Structure

```
├── chess_imitation_learning.py  # Main Python script for training and testing the model
├── README.md                    # Project documentation (this file)
└── requirements.txt             # List of required Python libraries
```

## Prerequisites

### Python Libraries

You need the following Python libraries:

- **python-chess**: For interacting with the chess board and Stockfish.
- **PyTorch**: For building and training the neural network.
- **Stockfish**: The chess engine used for generating expert moves.

You can install these libraries and setup a virtual env as:

```bash
make
```

### Stockfish

You'll need to install the **Stockfish** chess engine. 

#### Ubuntu:
```bash
sudo apt install stockfish
```

For other operating systems, download and install Stockfish from the official [Stockfish website](https://stockfishchess.org/download/).

### Neural Network Architecture

The neural network (`ChessNet`) is a simple fully connected feedforward network with the following architecture:
- Input: Board state (8x8x12 tensor flattened into a vector).
- Hidden layers: Two fully connected layers with ReLU activations.
- Output: A vector representing 4096 possible chess moves (64x64 grid for from/to squares).

## How to Run the Project

### Step 1: Clone the Repository

First, clone this repository to your local machine:

```bash
git clone https://github.com/your-username/Chess-RL.git
cd Chess-RL
```

### Step 2: Install Dependencies

Make sure you have all required dependencies installed. You can install them using the provided `requirements.txt` file:

```bash
make
```

### Step 3: Run the Script

Run the main script to generate data, train the model, and test its predictions:

```bash
./venv/bin/python3 chess_il.py
```

### Step 4: Testing the Model

Once the training is complete, the model will predict the best move for a random initial board state (as a simple test).

## How the Code Works

1. **Data Generation**: 
    - Stockfish is used to play random chess positions, and for each position, it returns the best move.
    - These board positions and corresponding moves are stored as training data.

2. **Model Training**:
    - The training data is fed to a neural network (implemented using PyTorch) which learns to predict the best move from a given board state.
    - Training is done using a supervised learning approach where the loss function is the cross-entropy between the predicted move and the move suggested by Stockfish.

3. **Move Prediction**:
    - After training, the model can predict the optimal move for a given board position by outputting the most probable move (encoded as from-square and to-square).

## Example Output

During training, you will see output like this:
```
Generating data using Stockfish...
Training model...
Epoch [1/5], Loss: 0.4567
Epoch [2/5], Loss: 0.3189
...
Testing the model on a random position...
Predicted move: e2e4
```

The predicted move is displayed after testing the model on a random chess position.

## Next Steps

- **Improve the Dataset**: You can generate more training data by playing more games or using different chess openings.
- **Optimize the Neural Network**: Try using more advanced architectures like convolutional neural networks (CNNs) or transformers for better performance.
- **Reinforcement Learning**: Once the model is competent at making reasonable moves, you could expand the project to include reinforcement learning where the model learns through self-play.

## License

This project is licensed under the MPL-2.0 License. See the `LICENSE` file for details.

## Acknowledgments

- **Stockfish**: For providing the powerful chess engine.
- **PyTorch**: For enabling the neural network framework.
- **python-chess**: For providing the chess board manipulation utilities.

---

### Notes:
- Update the `STOCKFISH_PATH` in the Python script to point to the correct location of the Stockfish binary on your machine.
- The current model architecture is quite simple. For better performance, consider implementing more sophisticated models (e.g., AlphaZero-style convolutional networks or transformer models).

